#!/usr/bin/python
import sys
import os.path
import sys
from subprocess import call, Popen, PIPE
from utils.colors import print_info, print_error, print_warning
from itertools import chain
from collections import deque
import ConfigParser
import os.path


def main():
    cfgname = 'build.cfg'
    if not os.path.isfile(cfgname):
        print_error("No build configuration file found. Run 'workon' script.")
        sys.exit(1)
    
    config = ConfigParser.RawConfigParser()
    config.read(cfgname)

    name = config.get('Target', 'name')
    print_info("Compiling %s" % name)
    pname = 'flowbox-' + name
    ret = call(['cabal', 'install', pname, '--reinstall'] + sys.argv[1:])
    sys.exit(ret)

main()


